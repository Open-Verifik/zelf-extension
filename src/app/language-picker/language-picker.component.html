<div>
	<button mat-icon-button [matMenuTriggerFor]="languages">
		<ng-container *ngTemplateOutlet="flagImage; context: { $implicit: activeLang }"></ng-container>
	</button>

	<mat-menu #languages="matMenu" [xPosition]="'after'" [yPosition]="'below'" style="background-color: white !important">
		<ng-container *ngFor="let lang of availableLangs; trackBy: trackByFn">
			<button mat-menu-item *ngIf="lang" (click)="setActiveLang(lang.id)">
				<span class="flex items-center" fxLayout="row" fxLayoutAlign="start center">
					<ng-container *ngTemplateOutlet="flagImage; context: { $implicit: lang.id }"></ng-container>
					<span class="flag-label">{{ lang.label }}</span>
				</span>
			</button>
		</ng-container>
	</mat-menu>

	<ng-template let-lang #flagImage>
		<span class="relative w-6 shadow rounded-sm overflow-hidden" *ngIf="flagCodes[lang]">
			<img class="flag-img" [src]="'assets/images/flags/' + flagCodes[lang].toUpperCase() + '.svg'" [alt]="'Flag image for ' + lang" />
		</span>
	</ng-template>
</div>
